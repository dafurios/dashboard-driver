<div style='width: 800px;'>
  <div id="directions" style='width: 350px; height: 600px;'></div>
</div>

<!-- <script type="text/javascript">

handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'directions'}}, function(){
  markers = handler.addMarkers(<%=raw @hash.to_json %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});

</script> -->


<script type="text/javascript">


var directionsDisplay = new google.maps.DirectionsRenderer();
var directionsService = new google.maps.DirectionsService();

function calcRoute() {
  var origin      = new google.maps.LatLng(-36.8018, -73.0912);
  var destination = new google.maps.LatLng(-37.972,  -70.560);
  var request = {
      origin:      origin,
      destination: destination,
      travelMode:  google.maps.TravelMode.DRIVING
  };
  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
    }
  });
}

calcRoute();

var handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'directions'}}, function(){
  directionsDisplay.setMap(handler.getMap());
});

</script>

<!-- <script type="text/javascript">

var handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'directions'} }, function(){
  // be aware chrome >= 50 requires https for geolocation to work
  if(navigator.geolocation)
  navigator.geolocation.getCurrentPosition(displayOnMap);
});

function displayOnMap(position){
  var marker = handler.addMarker({
    lat: position.coords.latitude,
    lng: position.coords.longitude
  });
  handler.map.centerOn(marker);
};

</script> -->

<script type="text/javascript">

var handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'directions'}}, function(){
  var markers = handler.addMarkers([
    { lat: -33, lng: -70},
    { lat: -33.5, lng: -70.5},
    { lat: -34, lng: -71},
    { lat: -30, lng: -71},
    { lat: -30, lng: -71},
    { lat: -30, lng: -71},
    { lat: -30, lng: -71},
    { lat: -36, lng: -71},
    { lat: -36, lng: -71},
    { lat: -30, lng: -70},
    { lat: -31, lng: -70},
    { lat: -32, lng: -70},
    { lat: -40, lng: -70},
    { lat: -40.5, lng: -70},
    { lat: -41, lng: -70},
    { lat: -41.5, lng: -70},
    { lat: -42, lng: -70},
    { lat: -42.5, lng: -70},
    { lat: -43, lng: -70}
  ]);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});

</script>
